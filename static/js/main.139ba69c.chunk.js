(this.webpackJsonpimagebook=this.webpackJsonpimagebook||[]).push([[0],{21:function(t,e,i){},22:function(t,e,i){},23:function(t,e,i){},24:function(t,e,i){},25:function(t,e,i){},26:function(t,e,i){"use strict";i.r(e);var n,a,s=i(0),r=i(1),o=i.n(r),h=i(12),l=i.n(h),c=(i(21),i(14)),g=i(15),u=i(7),d=i(2),p=i(3),f=i(5),v=i(4),y=i(6);!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(n||(n={})),function(t){t.SOFT="soft",t.HARD="hard"}(a||(a={}));var m,w,b,x=function(){function t(e,i){Object(d.a)(this,t),this.state=void 0,this.render=void 0,this.orientation=void 0,this.createdDensity=void 0,this.nowDrawingDensity=void 0,this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=i,this.nowDrawingDensity=this.createdDensity,this.render=e}return Object(p.a)(t,[{key:"setDensity",value:function(t){this.createdDensity=t,this.nowDrawingDensity=t}},{key:"setDrawingDensity",value:function(t){this.nowDrawingDensity=t}},{key:"setPosition",value:function(t){this.state.position=t}},{key:"setAngle",value:function(t){this.state.angle=t}},{key:"setArea",value:function(t){this.state.area=t}},{key:"setHardDrawingAngle",value:function(t){this.state.hardDrawingAngle=t}},{key:"setHardAngle",value:function(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}},{key:"setOrientation",value:function(t){this.orientation=t}},{key:"getDrawingDensity",value:function(){return this.nowDrawingDensity}},{key:"getDensity",value:function(){return this.createdDensity}},{key:"getHardAngle",value:function(){return this.state.hardAngle}}]),t}(),O=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,a)).image=null,s.isLoad=!1,s.loadingAngle=0,s.image=new Image,s.image.src=n,s}return Object(p.a)(i,[{key:"draw",value:function(t){var e=this.render.getContext(),i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,a=this.render.getRect().height;e.save(),e.translate(i.x,i.y),e.beginPath();var s,r=Object(y.a)(this.state.area);try{for(r.s();!(s=r.n()).done;){var o=s.value;null!==o&&(o=this.render.convertToGlobal(o),e.lineTo(o.x-i.x,o.y-i.y))}}catch(h){r.e(h)}finally{r.f()}e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,n,a):this.drawLoader(e,{x:0,y:0},n,a),e.restore()}},{key:"simpleDraw",value:function(t){var e=this.render.getRect(),i=this.render.getContext(),a=e.pageWidth,s=e.height,r=t===n.RIGHT?e.left+e.pageWidth:e.left,o=e.top;this.isLoad?i.drawImage(this.image,r,o,a,s):this.drawLoader(i,{x:r,y:o},a,s)}},{key:"drawLoader",value:function(t,e,i,n){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,i-1,n-1),t.stroke(),t.fill();var a={x:e.x+i/2,y:e.y+n/2};t.beginPath(),t.lineWidth=10,t.arc(a.x,a.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}},{key:"load",value:function(){var t=this;this.isLoad||(this.image.onload=function(){t.isLoad=!0})}},{key:"newTemporaryCopy",value:function(){return this}},{key:"getTemporaryCopy",value:function(){return this}},{key:"hideTemporaryCopy",value:function(){}}]),i}(x),P=function(){function t(){Object(d.a)(this,t)}return Object(p.a)(t,null,[{key:"GetDistanceBetweenTwoPoint",value:function(t,e){return null===t||null===e?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}},{key:"GetSegmentLength",value:function(e){return t.GetDistanceBetweenTwoPoint(e[0],e[1])}},{key:"GetAngleBetweenTwoLine",value:function(t,e){var i=t[0].y-t[1].y,n=e[0].y-e[1].y,a=t[1].x-t[0].x,s=e[1].x-e[0].x;return Math.acos((i*n+a*s)/(Math.sqrt(i*i+a*a)*Math.sqrt(n*n+s*s)))}},{key:"PointInRect",value:function(t,e){return null===e?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}},{key:"GetRotatedPoint",value:function(t,e,i){return{x:t.x*Math.cos(i)+t.y*Math.sin(i)+e.x,y:t.y*Math.cos(i)-t.x*Math.sin(i)+e.y}}},{key:"LimitPointToCircle",value:function(e,i,n){if(t.GetDistanceBetweenTwoPoint(e,n)<=i)return n;var a=e.x,s=e.y,r=n.x,o=n.y,h=Math.sqrt(Math.pow(i,2)*Math.pow(a-r,2)/(Math.pow(a-r,2)+Math.pow(s-o,2)))+a;n.x<0&&(h*=-1);var l=(h-a)*(s-o)/(a-r)+s;return a-r+s===0&&(l=i),{x:h,y:l}}},{key:"GetIntersectBetweenTwoSegment",value:function(e,i,n){return t.PointInRect(e,t.GetIntersectBeetwenTwoLine(i,n))}},{key:"GetIntersectBeetwenTwoLine",value:function(t,e){var i=t[0].y-t[1].y,n=e[0].y-e[1].y,a=t[1].x-t[0].x,s=e[1].x-e[0].x,r=t[0].x*t[1].y-t[1].x*t[0].y,o=e[0].x*e[1].y-e[1].x*e[0].y,h=i*o-n*r,l=a*o-s*r,c=-(r*s-o*a)/(i*s-n*a),g=-(i*o-n*r)/(i*s-n*a);if(isFinite(c)&&isFinite(g))return{x:c,y:g};if(Math.abs(h-l)<.1)throw new Error("Segment included");return null}},{key:"GetCordsFromTwoPoint",value:function(t,e){var i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y),a=Math.max(i,n),s=[t];function r(t,e,i,n,a){return e>t?t+a*(i/n):e<t?t-a*(i/n):t}for(var o=1;o<=a;o+=1)s.push({x:r(t.x,e.x,i,a,o),y:r(t.y,e.y,n,a,o)});return s}}]),t}(),S=function(){function t(e,i,n,a){Object(d.a)(this,t),this.direction=e,this.corner=i,this.angle=void 0,this.position=void 0,this.rect=void 0,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=void 0,this.pageHeight=void 0,this.pageWidth=parseInt(n,10),this.pageHeight=parseInt(a,10)}return Object(p.a)(t,[{key:"calc",value:function(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch(e){return!1}}},{key:"getFlippingClipArea",value:function(){var t=[],e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),null===this.sideIntersectPoint?e=!0:(t.push(this.sideIntersectPoint),null===this.bottomIntersectPoint&&(e=!1)),t.push(this.bottomIntersectPoint),(e||this.corner===w.BOTTOM)&&t.push(this.rect.bottomLeft),t}},{key:"getBottomClipArea",value:function(){var t=[];return t.push(this.topIntersectPoint),this.corner===w.TOP?t.push({x:this.pageWidth,y:0}):(null!==this.topIntersectPoint&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),null!==this.sideIntersectPoint?P.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):this.corner===w.TOP&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}},{key:"getAngle",value:function(){return this.direction===m.FORWARD?-this.angle:this.angle}},{key:"getRect",value:function(){return this.rect}},{key:"getPosition",value:function(){return this.position}},{key:"getActiveCorner",value:function(){return this.direction===m.FORWARD?this.rect.topLeft:this.rect.topRight}},{key:"getDirection",value:function(){return this.direction}},{key:"getFlippingProgress",value:function(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}},{key:"getCorner",value:function(){return this.corner}},{key:"getBottomPagePosition",value:function(){return this.direction===m.BACK?{x:this.pageWidth,y:0}:{x:0,y:0}}},{key:"getShadowStartPoint",value:function(){return this.corner===w.TOP?this.topIntersectPoint:null!==this.sideIntersectPoint?this.sideIntersectPoint:this.topIntersectPoint}},{key:"getShadowAngle",value:function(){var t=P.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===m.FORWARD?t:Math.PI-t}},{key:"calcAngleAndPosition",value:function(t){var e=t;if(this.updateAngleAndGeometry(e),e=this.corner===w.TOP?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}},{key:"updateAngleAndGeometry",value:function(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}},{key:"calculateAngle",value:function(t){var e=this.pageWidth-t.x+1,i=this.corner===w.BOTTOM?this.pageHeight-t.y:t.y,n=2*Math.acos(e/Math.sqrt(i*i+e*e));i<0&&(n=-n);var a=Math.PI-n;if(!isFinite(n)||a>=0&&a<.003)throw new Error("The G point is too small");return this.corner===w.BOTTOM&&(n=-n),n}},{key:"getPageRect",value:function(t){return this.corner===w.TOP?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}},{key:"getRectFromBasePoint",value:function(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}},{key:"getRotatedPoint",value:function(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}},{key:"calculateIntersectPoint",value:function(t){var e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner===w.TOP?(this.topIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=P.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}},{key:"checkPositionAtCenterLine",value:function(t,e,i){var n=t,a=P.LimitPointToCircle(e,this.pageWidth,n);n!==a&&(n=a,this.updateAngleAndGeometry(n));var s=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2)),r=this.rect.bottomRight,o=this.rect.topLeft;if(this.corner===w.BOTTOM&&(r=this.rect.topRight,o=this.rect.bottomLeft),r.x<=0){var h=P.LimitPointToCircle(i,s,o);h!==n&&(n=h,this.updateAngleAndGeometry(n))}return n}},{key:"getSegmentToShadowLine",value:function(){var t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&null!==this.sideIntersectPoint?this.sideIntersectPoint:this.bottomIntersectPoint]}}]),t}();!function(t){t[t.FORWARD=0]="FORWARD",t[t.BACK=1]="BACK"}(m||(m={})),function(t){t.TOP="top",t.BOTTOM="bottom"}(w||(w={})),function(t){t.USER_FOLD="user_fold",t.FOLD_CORNER="fold_corner",t.FLIPPING="flipping",t.READ="read"}(b||(b={}));var j,k=function(){function t(e,i){Object(d.a)(this,t),this.render=void 0,this.app=void 0,this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state=b.READ,this.render=e,this.app=i}return Object(p.a)(t,[{key:"fold",value:function(t){this.setState(b.USER_FOLD),null===this.calc&&this.start(t),this.do(this.render.convertToPage(t))}},{key:"flip",value:function(t){if((!this.app.getSettings().disableFlipByClick||this.isPointOnCorners(t))&&(null!==this.calc&&this.render.finishAnimation(),this.start(t))){var e=this.getBoundsRect();this.setState(b.FLIPPING);var i=e.height/10,n=this.calc.getCorner()===w.BOTTOM?e.height-i:i,a=this.calc.getCorner()===w.BOTTOM?e.height:0;this.calc.calc({x:e.pageWidth-i,y:n}),this.animateFlippingTo({x:e.pageWidth-i,y:n},{x:-e.pageWidth,y:a},!0)}}},{key:"start",value:function(t){this.reset();var e=this.render.convertToBook(t),i=this.getBoundsRect(),n=this.getDirectionByPoint(e),s=e.y>=i.height/2?w.BOTTOM:w.TOP;if(!this.checkDirection(n))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(n),this.bottomPage=this.app.getPageCollection().getBottomPage(n),this.render.getOrientation()===R.LANDSCAPE)if(n===m.BACK){var r=this.app.getPageCollection().nextBy(this.flippingPage);null!==r&&this.flippingPage.getDensity()!==r.getDensity()&&(this.flippingPage.setDrawingDensity(a.HARD),r.setDrawingDensity(a.HARD))}else{var o=this.app.getPageCollection().prevBy(this.flippingPage);null!==o&&this.flippingPage.getDensity()!==o.getDensity()&&(this.flippingPage.setDrawingDensity(a.HARD),o.setDrawingDensity(a.HARD))}return this.render.setDirection(n),this.calc=new S(n,s,i.pageWidth.toString(10),i.height.toString(10)),!0}catch(h){return!1}}},{key:"do",value:function(t){if(null!==this.calc&&this.calc.calc(t)){var e=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===m.FORWARD?this.flippingPage.setHardAngle(90*(200-2*e)/100):this.flippingPage.setHardAngle(-90*(200-2*e)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),e,this.calc.getDirection())}}},{key:"flipToPage",value:function(t,e){var i=this.app.getPageCollection().getCurrentSpreadIndex(),n=this.app.getPageCollection().getSpreadIndexByPage(t);try{n>i&&(this.app.getPageCollection().setCurrentSpreadIndex(n-1),this.flipNext(e)),n<i&&(this.app.getPageCollection().setCurrentSpreadIndex(n+1),this.flipPrev(e))}catch(a){}}},{key:"flipNext",value:function(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:t===w.TOP?1:this.render.getRect().height-2})}},{key:"flipPrev",value:function(t){this.flip({x:10,y:t===w.TOP?1:this.render.getRect().height-2})}},{key:"stopMove",value:function(){if(null!==this.calc){var t=this.calc.getPosition(),e=this.getBoundsRect(),i=this.calc.getCorner()===w.BOTTOM?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:i},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:i},!1)}}},{key:"showCorner",value:function(t){if(this.checkState(b.READ,b.FOLD_CORNER)){var e=this.getBoundsRect(),i=e.pageWidth;if(this.isPointOnCorners(t))if(null===this.calc){if(!this.start(t))return;this.setState(b.FOLD_CORNER),this.calc.calc({x:i-1,y:1});var n=this.calc.getCorner()===w.BOTTOM?e.height-1:1,a=this.calc.getCorner()===w.BOTTOM?e.height-50:50;this.animateFlippingTo({x:i-1,y:n},{x:i-50,y:a},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState(b.READ),this.render.finishAnimation(),this.stopMove()}}},{key:"animateFlippingTo",value:function(t,e,i){var n,a=this,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=P.GetCordsFromTwoPoint(t,e),o=[],h=Object(y.a)(r);try{var l=function(){var t=n.value;o.push((function(){return a.do(t)}))};for(h.s();!(n=h.n()).done;)l()}catch(g){h.e(g)}finally{h.f()}var c=this.getAnimationDuration(r.length);this.render.startAnimation(o,c,(function(){a.calc&&(i&&(a.calc.getDirection()===m.BACK?a.app.turnToPrevPage():a.app.turnToNextPage()),s&&(a.render.setBottomPage(null),a.render.setFlippingPage(null),a.render.clearShadow(),a.setState(b.READ),a.reset()))}))}},{key:"getCalculation",value:function(){return this.calc}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){this.state!==t&&(this.app.updateState(t),this.state=t)}},{key:"getDirectionByPoint",value:function(t){var e=this.getBoundsRect();if(this.render.getOrientation()===R.PORTRAIT){if(t.x-e.pageWidth<=e.width/5)return m.BACK}else if(t.x<e.width/2)return m.BACK;return m.FORWARD}},{key:"getAnimationDuration",value:function(t){var e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}},{key:"checkDirection",value:function(t){return t===m.FORWARD?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}},{key:"reset",value:function(){this.calc=null,this.flippingPage=null,this.bottomPage=null}},{key:"getBoundsRect",value:function(){return this.render.getRect()}},{key:"checkState",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0,a=e;n<a.length;n++){var s=a[n];if(this.state===s)return!0}return!1}},{key:"isPointOnCorners",value:function(t){var e=this.getBoundsRect(),i=e.pageWidth,n=Math.sqrt(Math.pow(i,2)+Math.pow(e.height,2))/5,a=this.render.convertToBook(t);return a.x>0&&a.y>0&&a.x<e.width&&a.y<e.height&&(a.x<n||a.x>e.width-n)&&(a.y<n||a.y>e.height-n)}}]),t}();!function(t){t.FIXED="fixed",t.STRETCH="stretch"}(j||(j={}));var R,T=function(){function t(){Object(d.a)(this,t),this._default={startPage:0,size:j.FIXED,width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!1,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}return Object(p.a)(t,[{key:"getSettings",value:function(t){var e=this._default;if(Object.assign(e,t),e.size!==j.STRETCH&&e.size!==j.FIXED)throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return e.size===j.STRETCH?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}]),t}();!function(t){t.PORTRAIT="portrait",t.LANDSCAPE="landscape"}(R||(R={}));var C=function(){function t(e,i){Object(d.a)(this,t),this.setting=void 0,this.app=void 0,this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=i,this.app=e;var n=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=null!==n.exec(window.navigator.userAgent)}return Object(p.a)(t,[{key:"render",value:function(t){if(null!==this.animation){var e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}},{key:"start",value:function(){var t=this;this.update();requestAnimationFrame((function e(i){t.render(i),requestAnimationFrame(e)}))}},{key:"startAnimation",value:function(t,e,i){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:i,startedAt:this.timer}}},{key:"finishAnimation",value:function(){null!==this.animation&&(this.animation.frames[this.animation.frames.length-1](),null!==this.animation.onAnimateEnd&&this.animation.onAnimateEnd()),this.animation=null}},{key:"update",value:function(){this.boundsRect=null;var t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}},{key:"calculateBoundsRect",value:function(){var t=R.LANDSCAPE,e=this.getBlockWidth(),i=e/2,n=this.getBlockHeight()/2,a=this.setting.width/this.setting.height,s=this.setting.width,r=this.setting.height,o=i-s;return this.setting.size===j.STRETCH?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t=R.PORTRAIT),(s=t===R.PORTRAIT?this.getBlockWidth():this.getBlockWidth()/2)>this.setting.maxWidth&&(s=this.setting.maxWidth),(r=s/a)>this.getBlockHeight()&&(s=(r=this.getBlockHeight())*a),o=t===R.PORTRAIT?i-s/2-s:i-s):e<2*s&&this.app.getSettings().usePortrait&&(t=R.PORTRAIT,o=i-s/2-s),this.boundsRect={left:o,top:n-r/2,width:2*s,height:r,pageWidth:s},t}},{key:"setShadowData",value:function(t,e,i,n){if(this.app.getSettings().drawShadow){var a=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*i/100,opacity:(100-i)*a/100/100,direction:n,progress:2*i}}}},{key:"clearShadow",value:function(){this.shadow=null}},{key:"getBlockWidth",value:function(){return this.app.getUI().getDistElement().offsetWidth}},{key:"getBlockHeight",value:function(){return this.app.getUI().getDistElement().offsetHeight}},{key:"getDirection",value:function(){return this.direction}},{key:"getRect",value:function(){return null===this.boundsRect&&this.calculateBoundsRect(),this.boundsRect}},{key:"getSettings",value:function(){return this.app.getSettings()}},{key:"getOrientation",value:function(){return this.orientation}},{key:"setPageRect",value:function(t){this.pageRect=t}},{key:"setDirection",value:function(t){this.direction=t}},{key:"setRightPage",value:function(t){null!==t&&t.setOrientation(n.RIGHT),this.rightPage=t}},{key:"setLeftPage",value:function(t){null!==t&&t.setOrientation(n.LEFT),this.leftPage=t}},{key:"setBottomPage",value:function(t){null!==t&&t.setOrientation(this.direction===m.BACK?n.LEFT:n.RIGHT),this.bottomPage=t}},{key:"setFlippingPage",value:function(t){null!==t&&t.setOrientation(this.direction===m.FORWARD&&this.orientation!==R.PORTRAIT?n.LEFT:n.RIGHT),this.flippingPage=t}},{key:"convertToBook",value:function(t){var e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}},{key:"isSafari",value:function(){return this.safari}},{key:"convertToPage",value:function(t,e){e||(e=this.direction);var i=this.getRect();return{x:e===m.FORWARD?t.x-i.left-i.width/2:i.width/2-t.x+i.left,y:t.y-i.top}}},{key:"convertToGlobal",value:function(t,e){if(e||(e=this.direction),null==t)return null;var i=this.getRect();return{x:e===m.FORWARD?t.x+i.left+i.width/2:i.width/2-t.x+i.left,y:t.y+i.top}}},{key:"convertRectToGlobal",value:function(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}]),t}(),I=function(){function t(e,i){Object(d.a)(this,t),this.app=void 0,this.render=void 0,this.isShowCover=void 0,this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=i,this.app=e,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}return Object(p.a)(t,[{key:"destroy",value:function(){this.pages=[]}},{key:"createSpread",value:function(){this.landscapeSpread=[],this.portraitSpread=[];for(var t=0;t<this.pages.length;t++)this.portraitSpread.push([t]);var e=0;this.isShowCover&&(this.pages[0].setDensity(a.HARD),this.landscapeSpread.push([e]),e++);for(var i=e;i<this.pages.length;i+=2)i<this.pages.length-1?this.landscapeSpread.push([i,i+1]):(this.landscapeSpread.push([i]),this.pages[i].setDensity(a.HARD))}},{key:"getSpread",value:function(){return this.render.getOrientation()===R.LANDSCAPE?this.landscapeSpread:this.portraitSpread}},{key:"getSpreadIndexByPage",value:function(t){for(var e=this.getSpread(),i=0;i<e.length;i++)if(t===e[i][0]||t===e[i][1])return i;return null}},{key:"getPageCount",value:function(){return this.pages.length}},{key:"getPages",value:function(){return this.pages}},{key:"getPage",value:function(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}},{key:"nextBy",value:function(t){var e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}},{key:"prevBy",value:function(t){var e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}},{key:"getFlippingPage",value:function(t){var e=this.currentSpreadIndex;if(this.render.getOrientation()===R.PORTRAIT)return t===m.FORWARD?this.pages[e].newTemporaryCopy():this.pages[e-1];var i=t===m.FORWARD?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===i.length||t===m.FORWARD?this.pages[i[0]]:this.pages[i[1]]}},{key:"getBottomPage",value:function(t){var e=this.currentSpreadIndex;if(this.render.getOrientation()===R.PORTRAIT)return t===m.FORWARD?this.pages[e+1]:this.pages[e-1];var i=t===m.FORWARD?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===i.length?this.pages[i[0]]:t===m.FORWARD?this.pages[i[1]]:this.pages[i[0]]}},{key:"showNext",value:function(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}},{key:"showPrev",value:function(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}},{key:"getCurrentPageIndex",value:function(){return this.currentPageIndex}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t&&(t=this.currentPageIndex),!(t<0||t>=this.pages.length)){var e=this.getSpreadIndexByPage(t);null!==e&&(this.currentSpreadIndex=e,this.showSpread())}}},{key:"getCurrentSpreadIndex",value:function(){return this.currentSpreadIndex}},{key:"setCurrentSpreadIndex",value:function(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}},{key:"showSpread",value:function(){var t=this.getSpread()[this.currentSpreadIndex];2===t.length?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):this.render.getOrientation()===R.LANDSCAPE&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}]),t}(),A=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,n)).imagesHref=void 0,s.imagesHref=a,s}return Object(p.a)(i,[{key:"load",value:function(){var t,e=Object(y.a)(this.imagesHref);try{for(e.s();!(t=e.n()).done;){var i=t.value,n=new O(this.render,i,a.SOFT);n.load(),this.pages.push(n)}}catch(s){e.e(s)}finally{e.f()}this.createSpread()}}]),i}(I),D=i(10),E=i(8),L=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,a)).element=void 0,s.copiedElement=null,s.temporaryCopy=null,s.isLoad=!1,s.element=n,s.element.classList.add("stf__item"),s.element.classList.add("--"+a),s}return Object(p.a)(i,[{key:"newTemporaryCopy",value:function(){return this.nowDrawingDensity===a.HARD?this:(null===this.temporaryCopy&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new i(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}},{key:"getTemporaryCopy",value:function(){return this.temporaryCopy}},{key:"hideTemporaryCopy",value:function(){null!==this.temporaryCopy&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}},{key:"draw",value:function(t){var e=t||this.nowDrawingDensity,i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,s=this.render.getRect().height;this.element.classList.remove("--simple"),this.element.style.display="block",this.element.style.left="0",this.element.style.top="0",this.element.style.width=n+"px",this.element.style.height=s+"px",e===a.HARD?this.drawHard():this.drawSoft(i)}},{key:"drawHard",value:function(){var t=this.render.getRect().left+this.render.getRect().width/2,e=this.state.hardDrawingAngle;this.element.style.backfaceVisibility="hidden",this.element.style.setProperty("-webkit-backface-visibility","hidden"),this.orientation===n.LEFT?(this.element.style.transformOrigin=this.render.getRect().pageWidth+"px 0",this.element.style.transform="translate3d(0px, 0px, 0) rotateY("+e+"deg)"):(this.element.style.transformOrigin="0 0",this.element.style.transform="translate3d("+t+"px, 0px, 0) rotateY("+e+"deg)"),this.element.style.clipPath="none",this.element.style.setProperty("-webkit-clip-path","none")}},{key:"drawSoft",value:function(t){var e,i="polygon( ",n=Object(y.a)(this.state.area);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(null!==a){var s=this.render.getDirection()===m.BACK?{x:-a.x+this.state.position.x,y:a.y-this.state.position.y}:{x:a.x-this.state.position.x,y:a.y-this.state.position.y};i+=(s=P.GetRotatedPoint(s,{x:0,y:0},this.state.angle)).x+"px "+s.y+"px, "}}}catch(r){n.e(r)}finally{n.f()}i=i.slice(0,-2),i+=")",this.element.style.transformOrigin="0 0",this.render.isSafari()&&0===this.state.angle?this.element.style.transform="translate("+t.x+"px, "+t.y+"px)":this.element.style.transform="translate3d("+t.x+"px, "+t.y+"px, 0) rotate("+this.state.angle+"rad)",this.element.style.clipPath=i,this.element.style.setProperty("-webkit-clip-path",i)}},{key:"simpleDraw",value:function(t){if(!this.element.classList.contains("--simple")){var e=this.render.getRect(),i=e.pageWidth,a=e.height,s=t===n.RIGHT?e.left+e.pageWidth:e.left,r=e.top;this.element.classList.add("--simple"),this.element.style.cssText="\n            position: absolute; \n            display: block; \n            height: ".concat(a,"px; \n            left: ").concat(s,"px; \n            top: ").concat(r,"px; \n            width: ").concat(i,"px; \n            z-index: ").concat(this.render.getSettings().startZIndex+1,";")}}},{key:"clearSaved",value:function(){this.element.classList.remove("--simple"),null!==this.copiedElement&&(this.copiedElement.remove(),this.copiedElement=null)}},{key:"getElement",value:function(){return this.element}},{key:"load",value:function(){this.isLoad=!0}},{key:"setOrientation",value:function(t){Object(D.a)(Object(E.a)(i.prototype),"setOrientation",this).call(this,t),this.element.classList.remove("--left","--right"),this.element.classList.add(t===n.RIGHT?"--right":"--left")}},{key:"setDrawingDensity",value:function(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),Object(D.a)(Object(E.a)(i.prototype),"setDrawingDensity",this).call(this,t)}}]),i}(x),M=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a,s){var r;return Object(d.a)(this,i),(r=e.call(this,t,n)).element=void 0,r.pagesElement=void 0,r.element=a,r.pagesElement=s,r}return Object(p.a)(i,[{key:"load",value:function(){var t,e=Object(y.a)(this.pagesElement);try{for(e.s();!(t=e.n()).done;){var i=t.value,n=new L(this.render,i,"hard"===i.dataset.density?a.HARD:a.SOFT);n.load(),this.pages.push(n)}}catch(s){e.e(s)}finally{e.f()}this.createSpread()}}]),i}(I),F=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,n)).canvas=void 0,s.ctx=void 0,s.canvas=a,s.ctx=a.getContext("2d"),s}return Object(p.a)(i,[{key:"getContext",value:function(){return this.ctx}},{key:"reload",value:function(){}},{key:"drawFrame",value:function(){this.clear(),this.orientation!==R.PORTRAIT&&null!=this.leftPage&&this.leftPage.simpleDraw(n.LEFT),null!=this.rightPage&&this.rightPage.simpleDraw(n.RIGHT),null!=this.bottomPage&&this.bottomPage.draw(),this.drawBookShadow(),null!=this.flippingPage&&this.flippingPage.draw(),null!=this.shadow&&(this.drawOuterShadow(),this.drawInnerShadow());var t=this.getRect();this.orientation===R.PORTRAIT&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}},{key:"drawBookShadow",value:function(){var t=this.getRect();this.ctx.save(),this.ctx.beginPath();var e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);var i={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(i.x,i.y);var n=this.ctx.createLinearGradient(0,0,e,0);n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),n.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),n.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),n.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}},{key:"drawOuterShadow",value:function(){var t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);var e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);var i=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===m.FORWARD?(this.ctx.translate(0,-100),i.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),i.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}},{key:"drawInnerShadow",value:function(){var t=this.getRect();this.ctx.save(),this.ctx.beginPath();var e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(i.topLeft.x,i.topLeft.y),this.ctx.lineTo(i.topRight.x,i.topRight.y),this.ctx.lineTo(i.bottomRight.x,i.bottomRight.y),this.ctx.lineTo(i.bottomLeft.x,i.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);var n=3*this.shadow.width/4,a=this.ctx.createLinearGradient(0,0,n,0);this.shadow.direction===m.FORWARD?(this.ctx.translate(-n,-100),a.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),a.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),a.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),a.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),a.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),a.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),a.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),a.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=a,this.ctx.fillRect(0,0,n,2*t.height),this.ctx.restore()}},{key:"clear",value:function(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}]),i}(C),H=function(){function t(e,i,n){var a=this;Object(d.a)(this,t),this.parentElement=void 0,this.app=void 0,this.wrapper=void 0,this.distElement=void 0,this.touchPoint=null,this.swipeTimeout=250,this.swipeDistance=void 0,this.onResize=function(){a.update()},this.onMouseDown=function(t){if(a.checkTarget(t.target)){var e=a.getMousePos(t.clientX,t.clientY);a.app.startUserTouch(e),t.preventDefault()}},this.onTouchStart=function(t){if(a.checkTarget(t.target)&&t.changedTouches.length>0){var e=t.changedTouches[0],i=a.getMousePos(e.clientX,e.clientY);a.touchPoint={point:i,time:Date.now()},setTimeout((function(){null!==a.touchPoint&&a.app.startUserTouch(i)}),a.swipeTimeout),a.app.getSettings().mobileScrollSupport||t.preventDefault()}},this.onMouseUp=function(t){var e=a.getMousePos(t.clientX,t.clientY);a.app.userStop(e)},this.onMouseMove=function(t){var e=a.getMousePos(t.clientX,t.clientY);a.app.userMove(e,!1)},this.onTouchMove=function(t){if(t.changedTouches.length>0){var e=t.changedTouches[0],i=a.getMousePos(e.clientX,e.clientY);a.app.getSettings().mobileScrollSupport?(null!==a.touchPoint&&(Math.abs(a.touchPoint.point.x-i.x)>10||a.app.getState()!==b.READ)&&t.cancelable&&a.app.userMove(i,!0),a.app.getState()!==b.READ&&t.preventDefault()):a.app.userMove(i,!0)}},this.onTouchEnd=function(t){if(t.changedTouches.length>0){var e=t.changedTouches[0],i=a.getMousePos(e.clientX,e.clientY),n=!1;if(null!==a.touchPoint){var s=i.x-a.touchPoint.point.x,r=Math.abs(i.y-a.touchPoint.point.y);Math.abs(s)>a.swipeDistance&&r<2*a.swipeDistance&&Date.now()-a.touchPoint.time<a.swipeTimeout&&(s>0?a.app.flipPrev(a.touchPoint.point.y<a.app.getRender().getRect().height/2?w.TOP:w.BOTTOM):a.app.flipNext(a.touchPoint.point.y<a.app.getRender().getRect().height/2?w.TOP:w.BOTTOM),n=!0),a.touchPoint=null}a.app.userStop(i,n)}},this.parentElement=e,e.classList.add("stf__parent"),e.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=e.querySelector(".stf__wrapper"),this.app=i;var s=this.app.getSettings().usePortrait?1:2;e.style.minWidth=n.minWidth*s+"px",e.style.minHeight=n.minHeight+"px",n.size===j.FIXED&&(e.style.minWidth=n.width*s+"px",e.style.minHeight=n.height+"px"),n.autoSize&&(e.style.width="100%",e.style.maxWidth=2*n.maxWidth+"px"),e.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=n.swipeDistance}return Object(p.a)(t,[{key:"destroy",value:function(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}},{key:"getDistElement",value:function(){return this.distElement}},{key:"getWrapper",value:function(){return this.wrapper}},{key:"setOrientationStyle",value:function(t){this.wrapper.classList.remove("--portrait","--landscape"),t===R.PORTRAIT?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}},{key:"removeHandlers",value:function(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}},{key:"setHandlers",value:function(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}},{key:"getMousePos",value:function(t,e){var i=this.distElement.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}},{key:"checkTarget",value:function(t){return!0!==this.app.getSettings().clickEventForward&&(!Array.isArray(this.app.getSettings().clickEventForward)||!this.app.getSettings().clickEventForward.includes(t.tagName.toLowerCase()))}}]),t}(),W=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a,s){var r;Object(d.a)(this,i),(r=e.call(this,t,n,a)).items=void 0,r.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),r.distElement=t.querySelector(".stf__block"),r.items=s;var o,h=Object(y.a)(s);try{for(h.s();!(o=h.n()).done;){var l=o.value;r.distElement.appendChild(l)}}catch(c){h.e(c)}finally{h.f()}return r.setHandlers(),r}return Object(p.a)(i,[{key:"clear",value:function(){var t,e=Object(y.a)(this.items);try{for(e.s();!(t=e.n()).done;){var i=t.value;this.parentElement.appendChild(i)}}catch(n){e.e(n)}finally{e.f()}}},{key:"updateItems",value:function(t){this.removeHandlers(),this.distElement.innerHTML="";var e,i=Object(y.a)(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.distElement.appendChild(n)}}catch(a){i.e(a)}finally{i.f()}this.items=t,this.setHandlers()}},{key:"update",value:function(){this.app.getRender().update()}}]),i}(H),B=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,n,a)).canvas=void 0,s.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',s.canvas=t.querySelectorAll("canvas")[0],s.distElement=s.canvas,s.resizeCanvas(),s.setHandlers(),s}return Object(p.a)(i,[{key:"resizeCanvas",value:function(){var t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=i}},{key:"getCanvas",value:function(){return this.canvas}},{key:"update",value:function(){this.resizeCanvas(),this.app.getRender().update()}}]),i}(H),N=function(){function t(){Object(d.a)(this,t),this.events=new Map}return Object(p.a)(t,[{key:"on",value:function(t,e){return this.events.has(t)?this.events.get(t).push(e):this.events.set(t,[e]),this}},{key:"off",value:function(t){this.events.delete(t)}},{key:"trigger",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.events.has(t)){var n,a=Object(y.a)(this.events.get(t));try{for(a.s();!(n=a.n()).done;){var s=n.value;s({data:i,object:e})}}catch(r){a.e(r)}finally{a.f()}}}}]),t}(),G=function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n,a){var s;return Object(d.a)(this,i),(s=e.call(this,t,n)).element=void 0,s.items=void 0,s.outerShadow=null,s.innerShadow=null,s.hardShadow=null,s.hardInnerShadow=null,s.element=a,s.createShadows(),s}return Object(p.a)(i,[{key:"createShadows",value:function(){this.element.insertAdjacentHTML("beforeend",'<div class="stf__outerShadow"></div>\n             <div class="stf__innerShadow"></div>\n             <div class="stf__hardShadow"></div>\n             <div class="stf__hardInnerShadow"></div>'),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}},{key:"clearShadow",value:function(){Object(D.a)(Object(E.a)(i.prototype),"clearShadow",this).call(this),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}},{key:"reload",value:function(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}},{key:"drawHardInnerShadow",value:function(){var t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress,i=(100-e)*(2.5*t.pageWidth)/100+20;i>t.pageWidth&&(i=t.pageWidth),this.hardInnerShadow.style.display="block",this.hardInnerShadow.style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.hardInnerShadow.style.width=i+"px",this.hardInnerShadow.style.height=t.height+"px",this.hardInnerShadow.style.background="linear-gradient(to right,\n            rgba(0, 0, 0, ".concat(this.shadow.opacity*e/100,") 5%,\n            rgba(0, 0, 0, 0) 100%)"),this.hardInnerShadow.style.left=t.left+t.width/2+"px",this.hardInnerShadow.style.transformOrigin="0 0",this.hardInnerShadow.style.transform=this.getDirection()===m.FORWARD&&this.shadow.progress>100||this.getDirection()===m.BACK&&this.shadow.progress<=100?"translate3d(0, 0, 0)":"translate3d(0, 0, 0) rotateY(180deg)"}},{key:"drawHardOuterShadow",value:function(){var t=this.getRect(),e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth),this.hardShadow.style.display="block",this.hardShadow.style.zIndex=(this.getSettings().startZIndex+4).toString(10),this.hardShadow.style.width=e+"px",this.hardShadow.style.height=t.height+"px",this.hardShadow.style.background="linear-gradient(to left,\n            rgba(0, 0, 0, ".concat(this.shadow.opacity,") 5%, rgba(0, 0, 0, 0) 100%)"),this.hardShadow.style.left=t.left+t.width/2+"px",this.hardShadow.style.transformOrigin="0 0",this.hardShadow.style.transform=this.getDirection()===m.FORWARD&&this.shadow.progress>100||this.getDirection()===m.BACK&&this.shadow.progress<=100?"translate3d(0, 0, 0) rotateY(180deg)":"translate3d(0, 0, 0)"}},{key:"drawInnerShadow",value:function(){for(var t=this.getRect(),e=3*this.shadow.width/4,i=this.getDirection()===m.FORWARD?e:0,n=this.getDirection()===m.FORWARD?"to left":"to right",a=this.convertToGlobal(this.shadow.pos),s=this.shadow.angle+3*Math.PI/2,r="polygon( ",o=0,h=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];o<h.length;o++){var l=h[o],c=this.getDirection()===m.BACK?{x:-l.x+this.shadow.pos.x,y:l.y-this.shadow.pos.y}:{x:l.x-this.shadow.pos.x,y:l.y-this.shadow.pos.y};r+=(c=P.GetRotatedPoint(c,{x:i,y:100},s)).x+"px "+c.y+"px, "}r=r.slice(0,-2),r+=")",this.innerShadow.style.display="block",this.innerShadow.style.zIndex=(this.getSettings().startZIndex+10).toString(10),this.innerShadow.style.width=e+"px",this.innerShadow.style.height=2*t.height+"px",this.innerShadow.style.background="linear-gradient(".concat(n,",\n            rgba(0, 0, 0, ").concat(this.shadow.opacity,") 5%,\n            rgba(0, 0, 0, 0.05) 15%,\n            rgba(0, 0, 0, ").concat(this.shadow.opacity,") 35%,\n            rgba(0, 0, 0, 0) 100%)"),this.innerShadow.style.transformOrigin=i+"px 100px",this.innerShadow.style.transform="translate3d(".concat(a.x-i,"px, ").concat(a.y-100,"px, 0) rotate(").concat(s,"rad)"),this.innerShadow.style.clipPath=r,this.innerShadow.style.setProperty("-webkit-clip-path",r)}},{key:"drawOuterShadow",value:function(){for(var t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.shadow.angle+3*Math.PI/2,n=this.getDirection()===m.BACK?this.shadow.width:0,a=this.getDirection()===m.FORWARD?"to right":"to left",s="polygon( ",r=0,o=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];r<o.length;r++){var h=o[r];if(null!==h){var l=this.getDirection()===m.BACK?{x:-h.x+this.shadow.pos.x,y:h.y-this.shadow.pos.y}:{x:h.x-this.shadow.pos.x,y:h.y-this.shadow.pos.y};s+=(l=P.GetRotatedPoint(l,{x:n,y:100},i)).x+"px "+l.y+"px, "}}s=s.slice(0,-2),s+=")",this.outerShadow.style.display="block",this.outerShadow.style.zIndex=(this.getSettings().startZIndex+10).toString(10),this.outerShadow.style.width=this.shadow.width+"px",this.outerShadow.style.height=2*t.height+"px",this.outerShadow.style.background="linear-gradient(".concat(a,", rgba(0, 0, 0, ").concat(this.shadow.opacity,"), rgba(0, 0, 0, 0))"),this.outerShadow.style.transformOrigin=n+"px 100px",this.outerShadow.style.transform="translate3d(".concat(e.x-n,"px, ").concat(e.y-100,"px, 0) rotate(").concat(i,"rad)"),this.outerShadow.style.clipPath=s,this.outerShadow.style.setProperty("-webkit-clip-path",s)}},{key:"drawLeftPage",value:function(){this.orientation!==R.PORTRAIT&&null!==this.leftPage&&(this.direction===m.BACK&&null!==this.flippingPage&&this.flippingPage.getDrawingDensity()===a.HARD?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(n.LEFT))}},{key:"drawRightPage",value:function(){null!==this.rightPage&&(this.direction===m.FORWARD&&null!==this.flippingPage&&this.flippingPage.getDrawingDensity()===a.HARD?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(n.RIGHT))}},{key:"drawBottomPage",value:function(){if(null!==this.bottomPage){var t=null!=this.flippingPage?this.flippingPage.getDrawingDensity():null;this.orientation===R.PORTRAIT&&this.direction===m.BACK||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}}},{key:"drawFrame",value:function(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),null!=this.flippingPage&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),null!=this.shadow&&null!==this.flippingPage&&(this.flippingPage.getDrawingDensity()===a.SOFT?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}},{key:"clear",value:function(){var t,e=Object(y.a)(this.app.getPageCollection().getPages());try{for(e.s();!(t=e.n()).done;){var i=t.value;i!==this.leftPage&&i!==this.rightPage&&i!==this.flippingPage&&i!==this.bottomPage&&(i.getElement().style.display="none"),i.getTemporaryCopy()!==this.flippingPage&&i.hideTemporaryCopy()}}catch(n){e.e(n)}finally{e.f()}}},{key:"update",value:function(){Object(D.a)(Object(E.a)(i.prototype),"update",this).call(this),null!==this.rightPage&&(this.rightPage.setOrientation(n.RIGHT),this.rightPage.clearSaved()),null!==this.leftPage&&(this.leftPage.setOrientation(n.LEFT),this.leftPage.clearSaved())}}]),i}(C),_=(i(22),function(t){Object(f.a)(i,t);var e=Object(v.a)(i);function i(t,n){var a;return Object(d.a)(this,i),(a=e.call(this)).mousePosition=void 0,a.isUserTouch=!1,a.isUserMove=!1,a.setting=null,a.block=void 0,a.pages=null,a.flipController=void 0,a.render=void 0,a.ui=void 0,a.setting=(new T).getSettings(n),a.block=t,a}return Object(p.a)(i,[{key:"destroy",value:function(){this.ui.destroy(),this.block.remove()}},{key:"update",value:function(){this.render.update(),this.pages.show()}},{key:"loadFromImages",value:function(t){var e=this;this.ui=new B(this.block,this,this.setting);var i=this.ui.getCanvas();this.render=new F(this,this.setting,i),this.flipController=new k(this.render,this),this.pages=new A(this,this.render,t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout((function(){e.ui.update(),e.trigger("init",e,{page:e.setting.startPage,mode:e.render.getOrientation()})}),1)}},{key:"loadFromHTML",value:function(t){var e=this;this.ui=new W(this.block,this,this.setting,t),this.render=new G(this,this.setting,this.ui.getDistElement()),this.flipController=new k(this.render,this),this.pages=new M(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout((function(){e.ui.update(),e.trigger("init",e,{page:e.setting.startPage,mode:e.render.getOrientation()})}),1)}},{key:"updateFromImages",value:function(t){var e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new A(this,this.render,t),this.pages.load(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}},{key:"updateFromHtml",value:function(t){var e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new M(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.ui.updateItems(t),this.render.reload(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}},{key:"clear",value:function(){this.pages.destroy(),this.ui.clear()}},{key:"turnToPrevPage",value:function(){this.pages.showPrev()}},{key:"turnToNextPage",value:function(){this.pages.showNext()}},{key:"turnToPage",value:function(t){this.pages.show(t)}},{key:"flipNext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.TOP;this.flipController.flipNext(t)}},{key:"flipPrev",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.TOP;this.flipController.flipPrev(t)}},{key:"flip",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.TOP;this.flipController.flipToPage(t,e)}},{key:"updateState",value:function(t){this.trigger("changeState",this,t)}},{key:"updatePageIndex",value:function(t){this.trigger("flip",this,t)}},{key:"updateOrientation",value:function(t){this.ui.setOrientationStyle(t),this.update(),this.trigger("changeOrientation",this,t)}},{key:"getPageCount",value:function(){return this.pages.getPageCount()}},{key:"getCurrentPageIndex",value:function(){return this.pages.getCurrentPageIndex()}},{key:"getPage",value:function(t){return this.pages.getPage(t)}},{key:"getRender",value:function(){return this.render}},{key:"getFlipController",value:function(){return this.flipController}},{key:"getOrientation",value:function(){return this.render.getOrientation()}},{key:"getBoundsRect",value:function(){return this.render.getRect()}},{key:"getSettings",value:function(){return this.setting}},{key:"getUI",value:function(){return this.ui}},{key:"getState",value:function(){return this.flipController.getState()}},{key:"getPageCollection",value:function(){return this.pages}},{key:"startUserTouch",value:function(t){this.mousePosition=t,this.isUserTouch=!0,this.isUserMove=!1}},{key:"userMove",value:function(t,e){this.isUserTouch||e||!this.setting.showPageCorners?this.isUserTouch&&P.GetDistanceBetweenTwoPoint(this.mousePosition,t)>5&&(this.isUserMove=!0,this.flipController.fold(t)):this.flipController.showCorner(t)}},{key:"userStop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isUserTouch&&(this.isUserTouch=!1,e||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(t)))}}]),i}(N)),z=o.a.forwardRef((function(t,e){var i=Object(r.useRef)(null),n=Object(r.useRef)([]),a=Object(r.useRef)(),h=Object(r.useState)([]),l=Object(u.a)(h,2),c=l[0],g=l[1];Object(r.useImperativeHandle)(e,(function(){return a.current}));var d=Object(r.useCallback)((function(){a.current&&a.current.clear()}),[]),p=Object(r.useCallback)((function(){var t=a.current;t&&(t.off("flip"),t.off("changeOrientation"),t.off("changeState"),t.off("init"),t.off("update"))}),[]);return Object(r.useEffect)((function(){if(n.current=[],t.children){var e=o.a.Children.map(t.children,(function(t){return o.a.cloneElement(t,{ref:function(t){t&&n.current.push(t)}})}));t.renderOnlyPageLengthChange&&c.length===e.length||(e.length<c.length&&d(),g(e))}}),[t.children]),Object(r.useEffect)((function(){c.length>0&&n.current.length>0&&(p(),i.current&&!a.current&&(a.current=new _(i.current,t)),a.current.getFlipController()?a.current.updateFromHtml(n.current):a.current.loadFromHTML(n.current),function(){var e=a.current;e&&(t.onFlip&&e.on("flip",(function(e){return t.onFlip(e)})),t.onChangeOrientation&&e.on("changeOrientation",(function(e){return t.onChangeOrientation(e)})),t.onChangeState&&e.on("changeState",(function(e){return t.onChangeState(e)})),t.onInit&&e.on("init",(function(e){return t.onInit(e)})),t.onUpdate&&e.on("update",(function(e){return t.onUpdate(e)})))}())}),[c]),Object(s.jsx)("div",{ref:i,className:t.className,style:t.style,children:c})})),U=o.a.memo(z),q=(i(23),i(24),o.a.forwardRef((function(t,e){switch(t.type){case"temp":return Object(s.jsx)("div",{className:"page",ref:e,"data-density":"soft",children:Object(s.jsxs)("div",{className:"page-content",children:["\xa0",Object(s.jsx)("div",{className:"page-footer",children:isNaN(t.pageNumber)?"":t.pageNumber})]})});case"cover":return Object(s.jsx)("div",{className:"page page-cover page-cover-"+t.pos,ref:e,"data-density":"soft",children:Object(s.jsx)("div",{className:"page-content",children:Object(s.jsx)("h2",{children:t.pageTitle})})});case"html":return Object(s.jsx)("div",{className:"page "+(t.no_animation?"no-animation":""),ref:e,"data-density":"soft",children:Object(s.jsxs)("div",{className:"page-content",children:[void 0!==t.pageTitle?Object(s.jsx)("h2",{className:"page-header",children:t.pageTitle}):null,Object(s.jsxs)("div",{className:"page-text",children:[null!==t.content.image&&""!==t.content.image?Object(s.jsx)("img",{style:{margin:"1%",float:"left"},src:"/imagebook/"+t.content.image,width:"40%",alt:""}):null,Object(s.jsx)("div",{dangerouslySetInnerHTML:{__html:t.content.html.outerHTML}})]}),Object(s.jsx)("div",{className:"page-footer",children:isNaN(t.pageNumber)?"":t.pageNumber})]})});case"contents":case"chapter":case"image":return Object(s.jsx)("div",{className:"page "+(t.no_animation?"no-animation":""),ref:e,"data-density":"soft",children:Object(s.jsxs)("div",{className:"page-content",children:[Object(s.jsxs)("div",{children:[void 0!==t.pageTitle?Object(s.jsx)("h2",{className:"page-header",children:t.pageTitle}):null,void 0!==t.image?Object(s.jsx)("div",{className:"page-image",children:Object(s.jsxs)("figure",{children:[Object(s.jsx)("img",{alt:t.imageCaption,src:t.image,onClick:function(t){t.target.requestFullscreen().then((function(){}))},onLoad:function(t){t.target.style=t.target.width>t.target.height?"width: 100%":"height: 100%"}}),Object(s.jsx)("figcaption",{children:t.imageCaption})]})}):null]}),t.children?Object(s.jsx)("div",{className:"page-text",children:t.children}):null,Object(s.jsx)("div",{className:"page-footer",children:isNaN(t.pageNumber)?"":t.pageNumber})]})});default:throw new Error("unrecognizable or missing page type")}}))),K=function t(e){var i=this;Object(d.a)(this,t),this.routes=[],this.mode=null,this.root="/",this.add=function(t,e){return i.routes.push({path:t,cb:e}),i},this.remove=function(t){for(var e=0;e<i.routes.length;e+=1)if(i.routes[e].path===t)return i.routes.slice(e,1),i;return i},this.flush=function(){return i.routes=[],i},this.clearSlashes=function(t){return t.toString().replace(/\/$/,"").replace(/^\//,"")},this.getFragment=function(){var t="";if("history"===i.mode)t=(t=i.clearSlashes(decodeURI(window.location.pathname+window.location.search))).replace(/\?(.*)$/,""),t="/"!==i.root?t.replace(i.root,""):t;else{var e=window.location.href.match(/#(.*)$/);t=e?e[1]:""}return i.clearSlashes(t)},this.navigate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"history"===i.mode?window.history.pushState(null,null,i.root+i.clearSlashes(t)):window.location.href="".concat(window.location.href.replace(/#(.*)$/,""),"#").concat(t),i},this.listen=function(){clearInterval(i.interval),i.interval=setInterval(i.interval,50)},this.interval=function(){i.current!==i.getFragment()&&(i.current=i.getFragment(),i.routes.some((function(t){var e=i.current.match(t.path);return!!e&&(e.shift(),t.cb.apply({},e),e)})))},this.mode=window.history.pushState?"history":"hash",e.mode&&(this.mode=e.mode),e.root&&(this.root=e.root),this.listen()},X=(i(25),document.getElementById("modal-root")),Y=o.a.forwardRef((function(t,e){var i=t.children,n=t.fade,a=void 0!==n&&n,o=t.defaultOpened,l=void 0!==o&&o,c=Object(r.useState)(l),g=Object(u.a)(c,2),d=g[0],p=g[1],f=Object(r.useCallback)((function(){return p(!1)}),[]);Object(r.useImperativeHandle)(e,(function(){return{open:function(){return p(!0)},close:f}}),[f]);var v=Object(r.useCallback)((function(t){27===t.keyCode&&f()}),[f]);return Object(r.useEffect)((function(){return d&&document.addEventListener("keydown",v,!1),function(){document.removeEventListener("keydown",v,!1)}}),[v,d]),Object(h.createPortal)(d?Object(s.jsxs)("div",{className:"modal ".concat(a?"modal-fade":""),children:[Object(s.jsx)("div",{className:"modal-overlay",onClick:f}),Object(s.jsxs)("div",{className:"modal-body",children:[Object(s.jsx)("div",{children:i}),Object(s.jsx)("span",{role:"button",className:"modal-close","aria-label":"close",onClick:f,children:"x"})]})]}):null,X)})),Z=function(){var t=Object(r.useState)(0),e=Object(u.a)(t,2),i=e[0],n=e[1],a=Object(r.useState)([]),o=Object(u.a)(a,2),h=o[0],l=o[1],d=Object(r.useState)(),p=Object(u.a)(d,2),f=p[0],v=p[1],y=Object(r.useState)({chapters:[],pageOfContents:0,pages:[]}),m=Object(u.a)(y,2),w=m[0],b=m[1],x=Object(r.useState)("hash"),O=Object(u.a)(x,1)[0],P=Object(r.useState)(),S=Object(u.a)(P,2),j=S[0],k=S[1],R=Object(r.useState)(),T=Object(u.a)(R,2),C=T[0],I=T[1],A=Object(r.useRef)(),D=Object(r.useRef)(null);Object(r.useEffect)((function(){return fetch("/imagebook/pages.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){t.json().then((function(t){var e=M(t);e.pages[e.pageOfContents-1]=Object(s.jsx)(q,{type:"contents",pageNumber:e.pageOfContents-1,pageTitle:e.pages[e.pageOfContents-1].props.pageTitle,children:Object(s.jsx)("ul",{className:"contents",children:e.chapters.map((function(t,e){return Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:("hash"===O?"#/":"")+String(t.pagenumber),onClick:H,children:t.pagetitle[i]})},e)}))})},e.pageOfContents-1);for(var n=e.pages.slice(0,3).concat(e.pages.slice(3,e.pages.length).map((function(t){return Object(s.jsx)(q,{type:"temp",pageNumber:t.props.pageNumber},t.props.pageNumber)}))),a=new Array(3).reduce((function(t,e,i){return t[i]=!0,t}),{}),r=0;r<3;r++)a[r]=!0;var o=new K({mode:O}),h=0;W(o.getFragment())?h=Number(o.getFragment()):o.navigate("/0");var c=E(n,a,e);l((function(){return c.updatedRenderedPages})),v((function(){return c.updatedPageMap})),b(e),I(o),k(h)}),(function(t){alert("Nem siker\xfclt bet\xf6lteni az oldalt!"),console.error(t)}))}),(function(t){alert("Nem siker\xfclt bet\xf6lteni az oldalt."),console.error(t)})),function(){}}),[i]),Object(r.useEffect)((function(){if(void 0!==A.current&&null!==f&&h.length>=j){var t=E(h,f,w);l((function(){return t.updatedRenderedPages})),v((function(){return t.updatedPageMap})),setTimeout((function(){h.length>=j?(A.current.flip(Number(j)),void 0!==C&&C.navigate("/"+j)):k(0)}),100)}}),[j]),Object(r.useEffect)((function(){}),[h]),Object(r.useEffect)((function(){}),[w]);var E=function(t,e,i){for(var n=Object(g.a)(t),a=Object(c.a)({},e),s=j-5;s<j+5;s++)s<0||s>t.length-1||void 0===e[s]&&(n[s]=i.pages[s],a[s]=!0);return{updatedRenderedPages:n,updatedPageMap:a}};Object(r.useEffect)((function(){var t=function(t){W(C.getFragment())&&k(Number(C.getFragment()))};return window.addEventListener("popstate",t),function(){window.removeEventListener("popstate",t)}}));var L=function(){k(Number(localStorage.getItem("bookmark")))},M=function(t){return t.reduce((function(e,n,a){if("chapter"===n.type&&e.chapters.push({pagetitle:n.pagetitle,pagenumber:e.pageCount}),"contents"===n.type&&(e.pageCount%2===1&&(e.pages.push(Object(s.jsx)(q,{type:"temp",pageNumber:e.pageCount},e.pageCount)),e.pageCount+=1),e.pageOfContents=e.pageCount+1),a+1===t.length&&e.pageCount%2===0&&(e.pages.push(Object(s.jsx)(q,{type:"temp",pageNumber:e.pageCount},e.pageCount)),e.pageCount+=1),"html"===n.type){var r=F(n.content[i].html,420,500);r.map((function(t,a){return Object(s.jsx)(q,{pageNumber:e.pageCount+a,type:n.type,pageTitle:n.pagetitle[i],content:0===a?{image:n.content[i].image,html:t}:{image:null,html:t}},e.pageCount+a)})).forEach((function(t){return e.pages.push(t)})),e.pageCount+=r.length,r.length>1&&(e.adjustedPageArrayLength+=r.length)}else{var o={key:e.pageCount,pageNumber:e.pageCount,type:n.type,pageTitle:n.pagetitle?n.pagetitle[i]:void 0};0===e.pageCount&&(o.bookmark=!0,o.onBookmark=L,o.pos="top"),e.pageCount===e.adjustedPageArrayLength-1&&(o.pos="bottom"),n.imagename&&(o.image="/imagebook/"+n.imagename,o.imageCaption=n.imagecaption[i]),e.pages.push(Object(s.jsx)(q,Object(c.a)({},o))),e.pageCount+=1}return e}),{chapters:[],pageCount:0,pageOfContents:0,pages:[],adjustedPageArrayLength:t.length})},F=function(t,e,i){var n=document.createElement("div");n.id="hiddendiv",n.style.width=e+"px",n.style.visibility="hidden",n.style.fontSize="120%",n.innerHTML=t;var a=[];document.body.appendChild(n),n.childNodes.forEach((function(t){3===t.nodeType?a.push(t.textContent):a.push(t.outerHTML)})),n.innerHTML="";var s=[],r=0;s[0]=document.createElement("article");for(var o=0;o<a.length;o++)n.innerHTML+=a[o],n.clientHeight>i&&(s[r+=1]=document.createElement("article"),n.innerHTML=""),s[r].innerHTML+=a[o];return document.body.removeChild(n),s},H=function(t){t.preventDefault(),k(Number(t.target.hash.substring(1).split("/")[1]))},W=function(t){return"string"==typeof t&&(!isNaN(t)&&!isNaN(parseFloat(t)))};return Object(s.jsxs)("div",{className:"d-flex flex-column",children:[Object(s.jsxs)("div",{className:"mt-1 align-self-end overflow-hidden",children:[Object(s.jsx)("button",{className:"m-1 button",onClick:function(){n((function(t){return 1===t?0:1}))},title:0===i?"Switch to english language":"Magyar nyelvre v\xe1lt\xe1s",children:0===i?Object(s.jsx)("span",{children:Object(s.jsx)("span",{className:"flag-icon",style:{backgroundImage:"url(/imagebook/gb.svg)"}})}):Object(s.jsx)("span",{children:Object(s.jsx)("span",{className:"flag-icon",style:{backgroundImage:"url(/imagebook/hu.svg)"}})})}),Object(s.jsx)("button",{className:"m-1 button",onClick:function(){D.current.open()},children:0===i?"Kapcsolat":"Contact"})]}),Object(s.jsx)("div",{className:"book-container container-md",children:h.length>0?Object(s.jsx)(U,{width:550,height:733,size:"stretch",minWidth:315,minHeight:400,maxWidth:1e3,maxHeight:1533,maxShadowOpacity:.5,flippingTime:700,showCover:!0,mobileScrollSupport:!0,clickEventForward:["img","button","a"],drawShadow:!0,swipeDistance:1,useMouseEvents:!0,showPageCorners:!1,onFlip:function(t){return k((function(){return t.data}))},className:"image-book",ref:A,children:h}):null}),Object(s.jsx)(Y,{fade:!0,ref:D,children:0===i?Object(s.jsxs)("div",{children:[Object(s.jsxs)("article",{children:[Object(s.jsx)("h4",{children:"Fest\u0151: Alim Adilov"}),Object(s.jsxs)("ul",{children:[Object(s.jsxs)("li",{children:["Email: ",Object(s.jsx)("a",{href:"mailto:",children:"alimadilov@gmail.com"})]}),Object(s.jsxs)("li",{children:["Facebook: ",Object(s.jsx)("a",{href:"https://www.facebook.com/alim.adilov",children:"Alim Adilov"})]}),Object(s.jsxs)("li",{children:["Telefon: ",Object(s.jsx)("a",{href:"tel:+36309416365",children:"+36309416365"})]})]})]}),Object(s.jsxs)("article",{children:[Object(s.jsx)("h4",{children:"Az oldalt k\xe9sz\xedtette: Musatics Gilbert"}),Object(s.jsxs)("ul",{children:[Object(s.jsxs)("li",{children:["Email: ",Object(s.jsx)("a",{href:"mailto:musaticsgilbert@gmail.comm",children:"musaticsgilbert@gmail.comm"})]}),Object(s.jsxs)("li",{children:["Facebook: ",Object(s.jsx)("a",{href:"https://www.facebook.com/profile.php?id=100006649936298",children:"Musatics Gilbert"})]})]})]}),Object(s.jsx)("article",{children:Object(s.jsxs)("footer",{children:["Az oldalon haszn\xe1lt megjelen\xedt\u0151: ",Object(s.jsx)("a",{href:"https://github.com/Nodlik/react-pageflip",children:"React-pageflip"})]})})]}):Object(s.jsxs)("div",{children:[Object(s.jsxs)("article",{children:[Object(s.jsx)("h4",{children:"Painter: Alim Adilov"}),Object(s.jsxs)("ul",{children:[Object(s.jsxs)("li",{children:["Email: ",Object(s.jsx)("a",{href:"mailto:",children:"alimadilov@gmail.com"})]}),Object(s.jsxs)("li",{children:["Facebook: ",Object(s.jsx)("a",{href:"https://www.facebook.com/alim.adilov",children:"Alim Adilov"})]}),Object(s.jsxs)("li",{children:["Phone: ",Object(s.jsx)("a",{href:"tel:+36309416365",children:"+36309416365"})]})]})]}),Object(s.jsxs)("article",{children:[Object(s.jsx)("h4",{children:"Webpage created by: Musatics Gilbert"}),Object(s.jsxs)("ul",{children:[Object(s.jsxs)("li",{children:["Email: ",Object(s.jsx)("a",{href:"mailto:musaticsgilbert@gmail.comm",children:"musaticsgilbert@gmail.com"})]}),Object(s.jsxs)("li",{children:["Facebook: ",Object(s.jsx)("a",{href:"https://www.facebook.com/profile.php?id=100006649936298",children:"Musatics Gilbert"})]})]})]}),Object(s.jsx)("article",{children:Object(s.jsxs)("footer",{children:["The book display library's source: ",Object(s.jsx)("a",{href:"https://github.com/Nodlik/react-pageflip",children:"React-pageflip"})]})})]})})]})},V=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,27)).then((function(e){var i=e.getCLS,n=e.getFID,a=e.getFCP,s=e.getLCP,r=e.getTTFB;i(t),n(t),a(t),s(t),r(t)}))};l.a.render(Object(s.jsx)(o.a.StrictMode,{children:Object(s.jsx)(Z,{})}),document.getElementById("root")),V()}},[[26,1,2]]]);
//# sourceMappingURL=main.139ba69c.chunk.js.map